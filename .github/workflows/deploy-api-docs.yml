name: Deploy REST API docs
on:
    push:
        branches:
            - develop
            - trunk
    workflow_dispatch:
jobs:
    build-and-deploy:
        name: Build and deploy
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v2
            - name: Build
              run: cd docs/rest-api && ./build.sh
            - name: Deploy to Netlify
              if: success()
              uses: jsmrcaga/action-netlify-deploy@v1.1.0
              with:
                  NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN_APIDOCS }}
                  NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID_APIDOCS }}
                  NETLIFY_DEPLOY_TO_PROD: true
                  build_directory: 'docs/rest-api/build'
                  install_command: 'echo null'
